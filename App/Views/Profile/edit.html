{% extends 'base.html' %}

{% block title %}Ustawienia{% endblock %}

{% block header %}

{% endblock %}

{% block footer %}
<script src="/js/hideShowPassword.min.js"></script>
<script src="/js/edit.js"></script>

<script>


$(document).ready(function () {
    $.ajax({
        url: '/Income/getIncome',
        method: 'POST',

        success: function (response) {
            createList("#formIncome", $.parseJSON(response), 'editModal','deleteModal','addModal');
        }, error: function () {
            alert('error: ');
        }
    });

    $.ajax({
        url: '/Expense/getExpense',
        method: 'POST',

        success: function (response) {
            createList("#formExpense", $.parseJSON(response), 'editExpense','deleteExpense','addExpense');
        }, error: function () {
            alert('error: ');
        }
    });

});
</script>
{% endblock %}

{% block body %}

<div class="d-flex justify-content-center">
  <h3><i class='fas fa-gear fa-fw me-2'></i>Ustawienia</h3>
</div>

{% if user.errors is not empty %}
<p>Errors:</p>
<ul>
  {% for error in user.errors %}
  <li>{{ error }}</li>
  {% endfor %}
</ul>
{% endif %}


<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editModalLabel">Edytuj kategorie</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form>
        <div class="modal-body">
          <div class="mb-3">
            <label for="category-name" class="col-form-label">Zamień na:</label>
            <input type="text" class="form-control" id="category-name" name="category-name" required>
            <input type="number" class="form-control" id="categoryId" name="categoryId" hidden>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="updateIncome">Aktualizuj</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Usuń kategorie</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form>
        <div class="modal-body" hidden>
          <div class="mb-3">
            <input type="number" class="form-control" id="categoryDeleteId" name="categoryDeleteId">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="deleteIncome">Usuń</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addIncomelLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addIncomelLabel">Dodaj</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form>
        <div class="modal-body">
          <div class="mb-3">
            <label for="newName" class="col-form-label">Dodaj nową kategorie:</label>
            <input type="text" class="form-control" id="newName" name="newName" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="addNew">Dodaj</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Edit expense -->
<div class="modal fade" id="editExpense" tabindex="-1" aria-labelledby="editExpenseLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editExpenseLabel">Edytuj kategorie</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form>
        <div class="modal-body">
          <div class="mb-3">
            <label for="category-name" class="col-form-label">Zamień na:</label>
            <input type="text" class="form-control" id="category-name" name="category-name" required>
            <input type="number" class="form-control" id="categoryId" name="categoryId" hidden>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="updateExpense">Aktualizuj</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Delete expense -->
<div class="modal fade" id="deleteExpense" tabindex="-1" aria-labelledby="deleteExpenseLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteExpenseLabel">Usuń kategorie</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form>
        <div class="modal-body" hidden>
          <div class="mb-3">
            <input type="number" class="form-control" id="categoryDeleteId" name="categoryDeleteId">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="deleteExpenseButton">Usuń</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Add expense -->
<div class="modal fade" id="addExpense" tabindex="-1" aria-labelledby="addExpenseLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addExpenseLabel">Dodaj</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form>
        <div class="modal-body">
          <div class="mb-3">
            <label for="newName" class="col-form-label">Dodaj nową kategorie:</label>
            <input type="text" class="form-control" id="newName" name="newName" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="addExpenseButton">Dodaj</button>
        </div>
      </form>
    </div>
  </div>
</div>


<button id="edit-profile" type="button" class="btn btn-outline-primary" style="width:100%">Edytuj profil</button>
<form method="post" id="formProfile" action="/profile/update" style="display:none">

  <div class="form-group">
    <label for="inputName">Name</label>
    <input id="inputName" name="name" placeholder="Name" value="{{ user.name }}" required class="form-control" />
  </div>
  <div class="form-group">
    <label for="inputEmail">Email address</label>
    <input id="inputEmail" name="email" placeholder="email address" value="{{ user.email }}" required type="email"
      class="form-control" />
  </div>
  <div class="form-group">
    <label for="inputPassword">Password</label>
    <input type="password" id="inputPassword" name="password" placeholder="Password" aria-describedby="helpBlock"
      class="form-control" />
    <span id="helpBlock" class="help-block">Zostaw puste hasło jeżeli nie chcesz go zmieniać</span>
  </div>

  <input type="checkbox" id="show-password">
  <label for="show-password">Show Password</label>

  <div class="d-grid mx-auto edit" style="width:95%">
    <button type="submit" class="btn btn-success">Zapisz zmiany</button>
  </div>

</form>

<button id="edit-income" type="button" class="btn btn-outline-primary" style="width:100%">Edytuj liste
  przychodów</button>
<ul id="formIncome" class="list-group w-100" style="display:none"></ul>

<button id="edit-expense" type="button" class="btn btn-outline-primary" style="width:100%">Edytuj liste
  wydatków</button>
<ul id="formExpense" class="list-group w-100" style="display:none"></ul>

<button id="edit-payment" type="button" class="btn btn-outline-primary" style="width:100%">Edytuj metody
  płatności</button>
<ul id="formPayment" class="list-group w-100" style="display:none"></ul>




{% endblock %}