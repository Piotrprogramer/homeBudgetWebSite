{% extends 'base.html' %}

{% block title %}Settings{% endblock %}

{% block header %}

{% endblock %}

{% block footer %}
<script src="/js/hideShowPassword.min.js"></script>
<script src="/js/edit.js"></script>

<script>
  $(document).ready(function () {


    $("#update_value").validate({
      rules: {
        category_name: {
          required: true,
        }
      },
      messages: {
        // Polish comment to action
        category_name: {
          required: "To pole jest wymagane."
        }
      },
      success: function () {
        $('#updateIncome').removeAttr('disabled');
        $('#updateExpense').removeAttr('disabled');
        $('#updatePayment').removeAttr('disabled');
      }
    });

    $("#add_value").validate({
      rules: {
        newName: {
          required: true,
        }
      },
      messages: {
        // Polish comment to action
        newName: {
          required: "To pole jest wymagane."
        }
      },
      success: function () {
        $('#addNew').removeAttr('disabled');
        $('#addExpenseButton').removeAttr('disabled');
        $('#addPayButton').removeAttr('disabled');
      }
    });

    $("#update_value").on('input', function () {
      if ($("#category_name").empty()) {
        $("#updateIncome").attr('disabled', true);
        $("#updateExpense").attr('disabled', true);
        $("#updatePayment").attr('disabled', true);
      }
    });



    



    //$("#updateIncome").attr('disabled', true); // Disable button on form validation error




    // $('#register').removeAttr('disabled');

  });





</script>
{% endblock %}

{% block body %}

<div class="d-flex justify-content-center">
  <h3><i class='fas fa-gear fa-fw me-2'></i>Ustawienia</h3>
</div>

{% if user.errors is not empty %}
<p>Errors:</p>
<ul>
  {% for error in user.errors %}
  <li>{{ error }}</li>
  {% endfor %}
</ul>
{% endif %}


<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editModalLabel">Edytuj kategorie</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="update_value">
        <div class="modal-body">
          <div class="mb-3">
            <label for="category_name" class="col-form-label">Zamień na:</label>
            <input type="text" class="form-control" id="category_name" name="category_name" required>
            <input type="number" class="form-control" id="categoryId" name="categoryId" hidden>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="updateIncome">Aktualizuj</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="updateExpense">Aktualizuj</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="updatePayment">Aktualizuj</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Usuń kategorie</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form>
        <div class="modal-body" hidden>
          <div class="mb-3">
            <input type="number" class="form-control" id="categoryDeleteId" name="categoryDeleteId">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="deleteIncome">Usuń</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="deleteExpenseButton">Usuń</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="deletePaymentButton">Usuń</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addIncomelLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addIncomelLabel">Dodaj</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="add_value">
        <div class="modal-body">
          <div class="mb-3">
            <label for="newName" class="col-form-label">Dodaj nową kategorie:</label>
            <input type="text" class="form-control" id="newName" name="newName" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="addNew" disabled>Dodaj</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="addExpenseButton" disabled>Dodaj</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="addPayButton" disabled>Dodaj</button>
        </div>
      </form>
    </div>
  </div>
</div>

<button id="edit-profile" type="button" class="btn my_button" style="width:100%">Edytuj profil</button>
<form method="post" id="formProfile" action="/profile/update" style="display:none">

  <div class="form-group">
    <label for="inputName">Name</label>
    <input id="inputName" name="name" placeholder="Name" value="{{ user.name }}" required class="form-control" />
  </div>
  <div class="form-group">
    <label for="inputEmail">Email address</label>
    <input id="inputEmail" name="email" placeholder="email address" value="{{ user.email }}" required type="email"
      class="form-control" />
  </div>
  <div class="form-group">
    <label for="inputPassword">Password</label>
    <input type="password" id="inputPassword" name="password" placeholder="Password" aria-describedby="helpBlock"
      class="form-control" />
    <span id="helpBlock" class="help-block">Zostaw puste hasło jeżeli nie chcesz go zmieniać</span>
  </div>

  <input type="checkbox" id="show-password">
  <label for="show-password">Show Password</label>

  <div class="d-grid mx-auto edit" style="width:95%">
    <button type="submit" class="btn bg-success bg-gradient">Zapisz zmiany</button>
  </div>

</form>

<button id="edit-income" type="button" class="btn my_button" style="width:100%">Edytuj liste
  przychodów</button>
<ul id="formIncome" class="list-group w-100" style="display:none"></ul>

<button id="edit-expense" type="button" class="btn my_button" style="width:100%">Edytuj liste
  wydatków</button>
<ul id="formExpense" class="list-group w-100" style="display:none"></ul>

<button id="edit-payment" type="button" class="btn my_button" style="width:100%">Edytuj metody
  płatności</button>
<ul id="formPayment" class="list-group w-100" style="display:none"></ul>

{% endblock %}